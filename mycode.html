<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Smart Energy Consumption Tracker (Demo)</title>
  <style>
    :root{--bg:#0f172a;--card:#111827;--text:#e5e7eb;--muted:#94a3b8;--accent:#22c55e;--warn:#f59e0b;--danger:#ef4444}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;background:linear-gradient(135deg,#0b1023,#141a33);color:var(--text)}
    .wrap{max-width:880px;margin:32px auto;padding:0 16px}
    .card{background:rgba(255,255,255,0.06);backdrop-filter: blur(6px);border:1px solid rgba(255,255,255,0.08);border-radius:18px; padding:18px 20px; box-shadow: 0 10px 30px rgba(0,0,0,.25)}
    h1{font-size:clamp(18px,2.8vw,28px);margin:0 0 10px} .sub{color:var(--muted);font-size:14px;margin-bottom:14px}
    .grid{display:grid;gap:14px;grid-template-columns:repeat(12,1fr)}
    .box{grid-column: span 4;background:rgba(0,0,0,.25);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:14px}
    .box h3{font-size:12px;text-transform:uppercase;letter-spacing:.12em;color:var(--muted);margin:0 0 8px}
    .num{font-size:26px;font-weight:700}
    .controls{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0}
    button{cursor:pointer;border:none;border-radius:999px;padding:10px 14px;font-weight:600}
    .primary{background:var(--accent)} .ghost{background:#1f2937;color:var(--text)} .danger{background:var(--danger)}
    label{font-size:12px;color:var(--muted);display:block;margin-bottom:6px}
    input{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:#0b1220;color:var(--text)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .progress{height:12px;border-radius:999px;background:#0b1220;border:1px solid rgba(255,255,255,.12);overflow:hidden}
    .bar{height:100%;width:0;background:linear-gradient(90deg,var(--accent),#16a34a)}
    .note{margin-top:8px;font-size:12px;color:var(--muted)}
    .alert{margin-top:10px;padding:10px;border-radius:10px;display:none}
    .alert.warn{background:#3b2e13;color:#fbbf24;border:1px solid #f59e0b}
    .alert.danger{background:#3b1111;color:#fca5a5;border:1px solid #ef4444}
    .history{margin-top:12px;background:rgba(0,0,0,.25);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:12px;max-height:180px;overflow:auto;font-size:12px}
    .muted{color:var(--muted)}
    @media (max-width:800px){.box{grid-column: span 12}.row{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>⚡ Smart Energy Consumption Tracker — Demo</h1>
      <div class="sub">Simulates real‑time power draw, tracks energy (kWh) and estimated cost. Set your tariff and a daily limit to get alerts.</div>

      <div class="row">
        <div>
          <label>Tariff (₹ per kWh)</label>
          <input id="tariff" type="number" min="0" step="0.01" value="8.00" />
        </div>
        <div>
          <label>Daily Limit (kWh)</label>
          <input id="limit" type="number" min="0" step="0.1" value="5.0" />
        </div>
      </div>

      <div class="controls">
        <button class="primary" id="startBtn">Start</button>
        <button class="ghost" id="stopBtn">Pause</button>
        <button class="danger" id="resetBtn">Reset</button>
      </div>

      <div class="grid">
        <div class="box">
          <h3>Current Power</h3>
          <div class="num"><span id="power">0</span> W</div>
          <div class="muted">Live reading (simulated)</div>
        </div>
        <div class="box">
          <h3>Energy Used (session)</h3>
          <div class="num"><span id="energy">0.000</span> kWh</div>
          <div class="muted">Updates every second</div>
        </div>
        <div class="box">
          <h3>Estimated Cost</h3>
          <div class="num">₹ <span id="cost">0.00</span></div>
          <div class="muted">Based on tariff</div>
        </div>
      </div>

      <div style="margin-top:14px">
        <div class="progress"><div class="bar" id="bar"></div></div>
        <div class="note">Daily limit usage: <b><span id="pct">0</span>%</b> — <span id="remain" class="muted"></span></div>
        <div id="alert" class="alert warn">⚠️ Approaching your daily limit.</div>
      </div>

      <div class="history" id="history"><b>History</b> (most recent first)
        <div class="muted">No samples yet.</div>
      </div>
    </div>
  </div>

  <script>
    // --- Simple simulation & tracker ---
    const powerEl = document.getElementById('power');
    const energyEl = document.getElementById('energy');
    const costEl = document.getElementById('cost');
    const tariffEl = document.getElementById('tariff');
    const limitEl = document.getElementById('limit');
    const pctEl = document.getElementById('pct');
    const remainEl = document.getElementById('remain');
    const barEl = document.getElementById('bar');
    const alertEl = document.getElementById('alert');
    const historyEl = document.getElementById('history');

    let running = false, timer = null;
    let powerW = 0;           // current power in Watts
    let energyKWh = 0;        // cumulative energy in kWh
    let lastTs = null;

    function randStep(curr){
      // random walk between 50W and 2000W, smoother changes
      const step = (Math.random() - 0.5) * 180; // +/- 90W
      let next = Math.max(50, Math.min(2000, curr + step));
      return Math.round(next);
    }

    function tick(){
      const now = performance.now();
      if(lastTs==null) lastTs = now;
      const dt = (now - lastTs) / 1000; // seconds
      lastTs = now;

      powerW = randStep(powerW || 400);
      energyKWh += (powerW * dt) / 3600000; // W * s -> Wh -> kWh

      const tariff = parseFloat(tariffEl.value)||0;
      const limit = Math.max(0.0001, parseFloat(limitEl.value)||5);
      const cost = energyKWh * tariff;
      const pct = Math.min(100, (energyKWh/limit)*100);
      const remain = Math.max(0, limit - energyKWh);

      powerEl.textContent = powerW.toString();
      energyEl.textContent = energyKWh.toFixed(3);
      costEl.textContent = cost.toFixed(2);
      pctEl.textContent = pct.toFixed(1);
      remainEl.textContent = `${remain.toFixed(2)} kWh remaining`;
      barEl.style.width = `${pct}%`;

      // alerts
      if(energyKWh >= limit){
        alertEl.className = 'alert danger';
        alertEl.style.display = 'block';
        alertEl.textContent = '⛔ Daily limit exceeded! Consider turning off non‑essential loads.';
      }else if(pct > 80){
        alertEl.className = 'alert warn';
        alertEl.style.display = 'block';
        alertEl.textContent = '⚠️ Approaching your daily limit.';
      }else{
        alertEl.style.display = 'none';
      }

      // history log (keep last 30)
      const ts = new Date().toLocaleTimeString();
      const line = document.createElement('div');
      line.textContent = `${ts} — ${powerW} W, ${energyKWh.toFixed(3)} kWh, ₹${cost.toFixed(2)}`;
      historyEl.prepend(line);
      while(historyEl.children.length > 32){ historyEl.removeChild(historyEl.lastChild); }
      if(historyEl.querySelector('.muted')) historyEl.querySelector('.muted').remove();
    }

    function start(){ if(running) return; running = true; lastTs = null; timer = setInterval(tick, 1000); }
    function stop(){ running = false; clearInterval(timer); }
    function reset(){ stop(); energyKWh = 0; powerW = 0; lastTs = null; powerEl.textContent='0'; energyEl.textContent='0.000'; costEl.textContent='0.00'; pctEl.textContent='0'; barEl.style.width='0%'; remainEl.textContent=''; alertEl.style.display='none'; historyEl.innerHTML='<b>History</b> (most recent first) <div class="muted">No samples yet.</div>'; }

    document.getElementById('startBtn').onclick = start;
    document.getElementById('stopBtn').onclick = stop;
    document.getElementById('resetBtn').onclick = reset;

    // auto-start for quick demo
    start();
  </script>
</body>
</html>
